<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Population 路 GEMS.jl</title><meta name="title" content="Population 路 GEMS.jl"/><meta property="og:title" content="Population 路 GEMS.jl"/><meta property="twitter:title" content="Population 路 GEMS.jl"/><meta name="description" content="Documentation for GEMS.jl."/><meta property="og:description" content="Documentation for GEMS.jl."/><meta property="twitter:description" content="Documentation for GEMS.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.jpeg" alt="GEMS.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">GEMS.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><span class="tocitem">Base Model</span><ul><li class="is-active"><a class="tocitem" href>Population</a><ul class="internal"><li><a class="tocitem" href="#Individuals-and-Settings"><span>Individuals and Settings</span></a></li><li><a class="tocitem" href="#pop-layers"><span>Layered Architecture</span></a></li><li><a class="tocitem" href="#setting-hierarchy"><span>Hierarchical Setting Structure</span></a></li><li class="toplevel"><a class="tocitem" href="#pop-generator"><span>Inbuilt Population Generator</span></a></li></ul></li><li><a class="tocitem" href="../base-contacts/">Contacts</a></li><li><a class="tocitem" href="../base-disease/">Disease</a></li><li><a class="tocitem" href="../TriSM/">Interventions</a></li><li><a class="tocitem" href="../base-config/">Default Parameters</a></li></ul></li><li><span class="tocitem">Running Simulations</span><ul><li><a class="tocitem" href="../tut_Intro/">Tutorials</a></li><li><a class="tocitem" href="../tut_gettingstarted/">1 - Getting Started</a></li><li><a class="tocitem" href="../tut_exploring/">2 - Exploring Models</a></li><li><a class="tocitem" href="../tut_plotting/">3 - Plotting</a></li><li><a class="tocitem" href="../tut_batches/">4 - Running Batches</a></li><li><a class="tocitem" href="../tut_pops/">5 - Creating Populations</a></li><li><a class="tocitem" href="../tut_configfiles/">6 - Advanced Parameterization</a></li><li><a class="tocitem" href="../tut_postprocessing/">7 - Logging &amp; Post-Processing</a></li><li><a class="tocitem" href="../tut_reporting/">8 - Reporting</a></li><li><a class="tocitem" href="../tut_npi/">9 - Modeling Interventions</a></li><li><a class="tocitem" href="../cheat-sheet/">Cheat Sheet</a></li></ul></li><li><a class="tocitem" href="../config-files/">Config Files</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../docstrings-overview/">Overview</a></li><li><a class="tocitem" href="../api_batch/">Batches</a></li><li><a class="tocitem" href="../api_contacts/">Contacts</a></li><li><a class="tocitem" href="../api_individuals/">Individuals</a></li><li><a class="tocitem" href="../api_infections/">Infections and Immunity</a></li><li><a class="tocitem" href="../api_interventions/">Interventions</a></li><li><a class="tocitem" href="../api_logger/">Logger</a></li><li><a class="tocitem" href="../api_mapping/">Mapping</a></li><li><a class="tocitem" href="../api_misc/">Misc</a></li><li><a class="tocitem" href="../api_movie/">Movie</a></li><li><a class="tocitem" href="../api_pathogens/">Pathogens</a></li><li><a class="tocitem" href="../api_plotting/">Plotting</a></li><li><a class="tocitem" href="../api_population/">Population</a></li><li><a class="tocitem" href="../api_postproc/">Post Processing</a></li><li><a class="tocitem" href="../api_reporting/">Reporting</a></li><li><a class="tocitem" href="../api_resultdata/">Result Data</a></li><li><a class="tocitem" href="../api_settings/">Settings</a></li><li><a class="tocitem" href="../api_simulation/">Simulation</a></li></ul></li><li><a class="tocitem" href="../contributing-guide/">Contributing to GEMS</a></li><li><a class="tocitem" href="../changelog/">Changelog</a></li><li><a class="tocitem" href="../faq-page/">FAQ</a></li><li><a class="tocitem" href="../glossary/">Glossary</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Base Model</a></li><li class="is-active"><a href>Population</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Population</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Base-Population-Model"><a class="docs-heading-anchor" href="#Base-Population-Model">Base Population Model</a><a id="Base-Population-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Base-Population-Model" title="Permalink"></a></h1><p>GEMS is a discrete-time static individual-based model with a superimposed network structure. As such, all actions (contacts, infections, deaths, etc...) are being calculated for each timestep (e.g., a day) before incrementing to the next timestep.</p><h2 id="Individuals-and-Settings"><a class="docs-heading-anchor" href="#Individuals-and-Settings">Individuals and Settings</a><a id="Individuals-and-Settings-1"></a><a class="docs-heading-anchor-permalink" href="#Individuals-and-Settings" title="Permalink"></a></h2><p>The only two entities in GEMS are <code>Individual</code>s and <code>Setting</code>s. <em>Individuals</em> are people that have personal characteristics, such as <code>age</code>, <code>sex</code>, and many more. Look up the documentation of the <code>Individual</code> object to get a full list of parameters.</p><p align="center">
    <img src="../assets/base-agents-and-settings.png" width="80%"/>
</p><p><em>Settings</em> are the (physical or social) contexts in which contacts can occur. A setting does always have a type (e.g., <em>Household</em> or <em>SchoolClass</em>) and can be geolocated. Individuals can belong to an arbitrary number of settings but only one of each type. Settings can hold an arbitrary number of individuals.</p><h2 id="pop-layers"><a class="docs-heading-anchor" href="#pop-layers">Layered Architecture</a><a id="pop-layers-1"></a><a class="docs-heading-anchor-permalink" href="#pop-layers" title="Permalink"></a></h2><p>GEMS&#39; base model architecture was designed with parallelization in mind. The model is segmented in disjunctive layers by setting type. We assume that each individual is only assigned to one setting of a particular setting type (no individual is assigned to two households, for example). This setup allows us to calculate all contacts and infections that happen during one timestep (e.g., one day) for all settings of a given type concurrently. The image below illustrates how individuals of the base population (green dots on the bottom layer) can be assigned to settings on each of the layers. A layer contains all settings of a given type (e.g., households). The edges between individuals on any of the upper layers indicates that these individuals each belong to the same setting of the respective type.</p><p><img src="../assets/base-population.png" alt="GEMS Base Population Model"/></p><p>Moreover, we only simulate infections in so-called <em>Active Settings</em>. These are settings that contain infectious individuals and can therefore produce infections during the current timestep. Settings without infectious individuals (in-active settings) are not being simulated as they do not contribute to the overall infection dynamics. Active Settings in the image above are visualized with a white glow around the individuals. Red circles are infectious individuals.</p><p>This approach cuts the simulation execution time drastically. In our benchmarks, we were able to simulate 80 million agents for one year with 75% total infections in roughly 30 minutes on a 24 core machine. We discuss these ideas in:</p><blockquote><p>Ponge, J., Horstkemper, D., Hellingrath, B., Bayer, L., Bock, W. and Karch, A., 2023, December. Evaluating Parallelization Strategies for Large-Scale Individual-based Infectious Disease Simulations. In <em>2023 Winter Simulation Conference (WSC)</em> (pp. 1088-1099). IEEE. https://doi.org/10.1109/WSC60868.2023.10407633</p></blockquote><h2 id="setting-hierarchy"><a class="docs-heading-anchor" href="#setting-hierarchy">Hierarchical Setting Structure</a><a id="setting-hierarchy-1"></a><a class="docs-heading-anchor-permalink" href="#setting-hierarchy" title="Permalink"></a></h2><p>Many places, such as schools or workplaces, can be very large. However, daily contacts often just occur between class mates or office colleauges. GEMS arranges settings hierarchically to represent these nested structures.</p><p align="center">
    <img src="../assets/base-setting-hierarchy.png" width="70%"/>
</p><p>We differentiate between <code>IndividualSetting</code>s and <code>ContainerSetting</code>s. The former are the settings that individuals have direct connections with. They are the lowest-level settings (e.g., School classes, offices, or households). The latter are the settings that aggregate the low-level settings to bigger ones (e.g., SchoolYears, Schools or Workplaces).</p><p>Individual Settings in GEMS are <code>Household</code>, <code>SchoolClass</code>, <code>Office</code>, and <code>Municipality</code>. Container Settings are available for school classes and offices on four layers each: <code>SchoolClass</code> -&gt; <code>SchoolYear</code> -&gt; <code>School</code> -&gt; <code>SchoolComplex</code> and <code>Office</code> -&gt; <code>Department</code> -&gt; <code>Workplace</code> -&gt; <code>WorkplaceSite</code>.</p><p>You can run a simulation with only Individual Settings. Container Settings are added via so-called &quot;settings files&quot;.</p><h1 id="pop-generator"><a class="docs-heading-anchor" href="#pop-generator">Inbuilt Population Generator</a><a id="pop-generator-1"></a><a class="docs-heading-anchor-permalink" href="#pop-generator" title="Permalink"></a></h1><p>If you setup a simulation without a custom population file like <code>sim = Simulation()</code>, GEMS will generate a <strong>non-representative</strong> baseline population on-the-fly. You can pass arguments <code>pop_size</code> (called <code>n</code> in the explanation below), <code>avg_household_size</code>, <code>avg_office_size</code>, and <code>avg_school_size</code> to the engine.</p><p align="center">
    <img src="../assets/base-sample-population-generation.png" width="100%"/>
</p><p>The population generator will first set up an empty dataframe with one row per individual (Step 1) and add the required number of households with one index individual per household (Step 2). Their ages will be randomly sampled from the German age distribution. We then iteratevly create the remainig individuals. To get a somewhat realistic household age-coupling of individuals, we first select on of the index individuals and sample the age for a new household member based on household contact data from the <a href="https://bmcmedicine.biomedcentral.com/articles/10.1186/s12916-021-02139-6">COVIMOD study</a> (Step 3). In the last step, we sample a school ID for every agent between the ages of 6 and 18, and an office for all agents between the ages of 18 and 65. While the example refers to &quot;schools&quot;, they are internally handled as <code>SchoolClass</code>es.</p><p>Here&#39;s a code snippet that visualizes the age- and household size distributions of such a generated population:</p><pre><code class="language-julia hljs">using GEMS, Plots
sim = Simulation()
ages = age.(individuals(sim))
hh_sizes = size.(households(sim))

plot(
    histogram(ages, label = &quot;Age&quot;, title = &quot;Age Distribution&quot;),
    histogram(hh_sizes, label = &quot;Size&quot;, title = &quot;Household Sizes&quot;,
        bins=1:maximum(hh_sizes) + 1,
        xticks = 1:maximum(hh_sizes) + 1),
    size = (800, 300)
)</code></pre><p align="center">
    <img src="../assets/base-sample-population-properties.png" width="60%"/>
</p><div class="admonition is-warning" id="This-does-only-apply-to-the-on-the-fly-genrated-populations!-1c9aa8541b19afc7"><header class="admonition-header">This does only apply to the on-the-fly genrated populations!<a class="admonition-anchor" href="#This-does-only-apply-to-the-on-the-fly-genrated-populations!-1c9aa8541b19afc7" title="Permalink"></a></header><div class="admonition-body"><p>If you are using any of the pre-built population models, e.g., via <code>Simulation(population = &quot;NRW&quot;)</code>, you will get a model that is based on the <a href="https://gesyland.eu/">Gesyland Project</a></p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../installation/">芦 Installation</a><a class="docs-footer-nextpage" href="../base-contacts/">Contacts 禄</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.0 on <span class="colophon-date" title="Monday 12 May 2025 10:12">Monday 12 May 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
